(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[473],{2304:function(t,e,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/auth",function(){return r(1305)}])},18:function(t,e,r){"use strict";var i=r(6154);e.Z=i.Z.create({baseURL:"https://palugada-cms-acba24770f44.herokuapp.com/api"})},1305:function(t,e,r){"use strict";r.r(e),r.d(e,{default:function(){return R}});var i=r(5893),a=r(389),n=r.n(a),o=r(7294),l=r(5675),s=r.n(l),c=r(3366),u=r(7462),d=r(6010),h=r(4780),p=r(1796),g=r(1496),f=r(3616),m=r(5097);let v=["absolute","children","className","component","flexItem","light","orientation","role","textAlign","variant"],x=t=>{let{absolute:e,children:r,classes:i,flexItem:a,light:n,orientation:o,textAlign:l,variant:s}=t;return(0,h.Z)({root:["root",e&&"absolute",s,n&&"light","vertical"===o&&"vertical",a&&"flexItem",r&&"withChildren",r&&"vertical"===o&&"withChildrenVertical","right"===l&&"vertical"!==o&&"textAlignRight","left"===l&&"vertical"!==o&&"textAlignLeft"],wrapper:["wrapper","vertical"===o&&"wrapperVertical"]},m.V,i)},w=(0,g.ZP)("div",{name:"MuiDivider",slot:"Root",overridesResolver:(t,e)=>{let{ownerState:r}=t;return[e.root,r.absolute&&e.absolute,e[r.variant],r.light&&e.light,"vertical"===r.orientation&&e.vertical,r.flexItem&&e.flexItem,r.children&&e.withChildren,r.children&&"vertical"===r.orientation&&e.withChildrenVertical,"right"===r.textAlign&&"vertical"!==r.orientation&&e.textAlignRight,"left"===r.textAlign&&"vertical"!==r.orientation&&e.textAlignLeft]}})(({theme:t,ownerState:e})=>(0,u.Z)({margin:0,flexShrink:0,borderWidth:0,borderStyle:"solid",borderColor:(t.vars||t).palette.divider,borderBottomWidth:"thin"},e.absolute&&{position:"absolute",bottom:0,left:0,width:"100%"},e.light&&{borderColor:t.vars?`rgba(${t.vars.palette.dividerChannel} / 0.08)`:(0,p.Fq)(t.palette.divider,.08)},"inset"===e.variant&&{marginLeft:72},"middle"===e.variant&&"horizontal"===e.orientation&&{marginLeft:t.spacing(2),marginRight:t.spacing(2)},"middle"===e.variant&&"vertical"===e.orientation&&{marginTop:t.spacing(1),marginBottom:t.spacing(1)},"vertical"===e.orientation&&{height:"100%",borderBottomWidth:0,borderRightWidth:"thin"},e.flexItem&&{alignSelf:"stretch",height:"auto"}),({theme:t,ownerState:e})=>(0,u.Z)({},e.children&&{display:"flex",whiteSpace:"nowrap",textAlign:"center",border:0,"&::before, &::after":{position:"relative",width:"100%",borderTop:`thin solid ${(t.vars||t).palette.divider}`,top:"50%",content:'""',transform:"translateY(50%)"}}),({theme:t,ownerState:e})=>(0,u.Z)({},e.children&&"vertical"===e.orientation&&{flexDirection:"column","&::before, &::after":{height:"100%",top:"0%",left:"50%",borderTop:0,borderLeft:`thin solid ${(t.vars||t).palette.divider}`,transform:"translateX(0%)"}}),({ownerState:t})=>(0,u.Z)({},"right"===t.textAlign&&"vertical"!==t.orientation&&{"&::before":{width:"90%"},"&::after":{width:"10%"}},"left"===t.textAlign&&"vertical"!==t.orientation&&{"&::before":{width:"10%"},"&::after":{width:"90%"}})),b=(0,g.ZP)("span",{name:"MuiDivider",slot:"Wrapper",overridesResolver:(t,e)=>{let{ownerState:r}=t;return[e.wrapper,"vertical"===r.orientation&&e.wrapperVertical]}})(({theme:t,ownerState:e})=>(0,u.Z)({display:"inline-block",paddingLeft:`calc(${t.spacing(1)} * 1.2)`,paddingRight:`calc(${t.spacing(1)} * 1.2)`},"vertical"===e.orientation&&{paddingTop:`calc(${t.spacing(1)} * 1.2)`,paddingBottom:`calc(${t.spacing(1)} * 1.2)`})),_=o.forwardRef(function(t,e){let r=(0,f.Z)({props:t,name:"MuiDivider"}),{absolute:a=!1,children:n,className:o,component:l=n?"div":"hr",flexItem:s=!1,light:h=!1,orientation:p="horizontal",role:g="hr"!==l?"separator":void 0,textAlign:m="center",variant:_="fullWidth"}=r,y=(0,c.Z)(r,v),A=(0,u.Z)({},r,{absolute:a,component:l,flexItem:s,light:h,orientation:p,role:g,textAlign:m,variant:_}),Z=x(A);return(0,i.jsx)(w,(0,u.Z)({as:l,className:(0,d.Z)(Z.root,o),role:g,ref:e,ownerState:A},y,{children:n?(0,i.jsx)(b,{className:Z.wrapper,ownerState:A,children:n}):null}))});var y=r(1903),A=r(3321),Z=r(8703),j=r(1737),N=r(1649),C=r(8599),S=r(7378),k=r(1163),E=r(9008),L=r.n(E);function R(){let t=(0,S.T)(),e=(0,k.useRouter)(),[r,a]=(0,o.useState)(!1),[l,c]=(0,o.useState)(""),[u,d]=(0,o.useState)(""),[h,p]=(0,o.useState)(!1),[g,f]=(0,o.useState)(!1),m=(0,N.v9)(t=>t.AuthReducer.isLoginError),v=(0,N.v9)(t=>t.AuthReducer.user);(0,o.useEffect)(()=>{localStorage.getItem("access_token")?(t((0,C.bc)({username:l,password:u})),e.push("/")):a(!0)},[]),(0,o.useEffect)(()=>{m&&(p(!0),t((0,C.g6)()))},[m]),(0,o.useEffect)(()=>{v&&(f(!0),setTimeout(()=>{f(!1),e.push("/")},2e3))},[v]);let x=e=>{e.preventDefault(),l&&u?t((0,C.bc)({username:l,password:u})):p(!0)},w=t=>{"clickaway"!==t&&(p(!1),f(!1))},b=t=>{"Enter"===t.key&&x(t)};return r?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(L(),{children:[(0,i.jsx)("title",{children:"LOGIN"}),(0,i.jsx)("link",{rel:"shortcut icon",href:"/company-logo.ico"})]}),(0,i.jsxs)("div",{className:n().root,children:[(0,i.jsx)("div",{className:n()["sub-root"],children:(0,i.jsx)(s(),{className:n().illustration,src:"/home-illustration.png",alt:"illustration",width:45,height:37,priority:!0})}),(0,i.jsx)("div",{className:n()["sub-root"],children:(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("h1",{className:n()["mb-10"],children:"SUMBER CAHAYA"}),(0,i.jsx)("h4",{className:n()["mb-10"],children:"#HANYAPELAYANANTERBAIK"}),(0,i.jsx)(_,{className:n().divider}),(0,i.jsx)(y.Z,{size:"small",type:"text",label:"Username",name:"Username",variant:"outlined",className:"".concat(n().input," ").concat(n()["mb-10"]),onChange:t=>c(t.target.value),onKeyDown:b}),(0,i.jsx)(y.Z,{size:"small",type:"password",name:"Password",label:"Password",variant:"outlined",className:"".concat(n().input," ").concat(n()["mb-10"]),onChange:t=>d(t.target.value),onKeyDown:b}),(0,i.jsx)(A.Z,{className:n()["primary-color"],onClick:x,children:"Login"})]})})]}),(0,i.jsx)(Z.Z,{open:h||m,autoHideDuration:2e3,onClose:(t,e)=>w(e),anchorOrigin:{vertical:"top",horizontal:"center"},children:(0,i.jsx)(j.Z,{onClose:()=>w(""),severity:"error",children:"Invalid Username/Password!"})}),(0,i.jsx)(Z.Z,{open:g,autoHideDuration:2e3,onClose:(t,e)=>w(e),anchorOrigin:{vertical:"top",horizontal:"center"},children:(0,i.jsx)(j.Z,{onClose:()=>w(""),severity:"success",children:"Welcome! Redirecting..."})})]}):(0,i.jsx)(i.Fragment,{})}},8599:function(t,e,r){"use strict";r.d(e,{$j:function(){return l},AW:function(){return s},g6:function(){return c},n1:function(){return o},bc:function(){return n},lK:function(){return u}});var i=r(18),a=r(5143);let n=t=>async e=>{try{let{data:r}=await i.Z.post("/login",{external_id:t.username,password:t.password});r&&(e({type:"auth/login",payload:r.user}),function(t){for(let e in t)localStorage.setItem(e,t[e])}({access_token:r.token}),e(l()))}catch(t){return e({type:"auth/loginError"}),t}},o=t=>async e=>{let{username:r,password:a,newPassword:n}=t;try{await i.Z.post("/change-password",{external_id:r,password:a,newPassword:n},{headers:{Authorization:"Bearer "+localStorage.getItem("access_token")}}),e({type:"auth/changePasswordSuccess"})}catch(t){return e({type:"auth/changePasswordError"}),t}},l=()=>async t=>{let e=localStorage.getItem("access_token"),{data:r}=await i.Z.get("/features",{headers:{Authorization:"Bearer "+e}});r&&t({type:"auth/features",payload:r.features})},s=t=>async e=>{try{let t=localStorage.getItem("access_token"),{data:r}=await i.Z.get("/profile",{headers:{Authorization:"Bearer "+t}});r&&e({type:"auth/login",payload:r})}catch(e){localStorage.removeItem("access_token"),t.push("/auth")}};function c(){return t=>{t({type:"auth/turnOffLoginError"})}}function u(){return t=>{t((0,a.L)("")),t({type:"auth/logout"})}}},5143:function(t,e,r){"use strict";function i(t){return e=>{e({type:"GC/loading-".concat(t?"on":"off")})}}function a(t){return e=>{e({type:"GC/set-route",payload:t})}}r.d(e,{L:function(){return a},c:function(){return i}})},389:function(t){t.exports={root:"Auth_root___1L5j","sub-root":"Auth_sub-root__N3XoN",illustration:"Auth_illustration__cFJsC",input:"Auth_input__KUi2x",divider:"Auth_divider__MsOTQ","primary-color":"Auth_primary-color__vyUAL","mb-10":"Auth_mb-10__r2I8G"}},9008:function(t,e,r){t.exports=r(2636)}},function(t){t.O(0,[288,774,888,179],function(){return t(t.s=2304)}),_N_E=t.O()}]);