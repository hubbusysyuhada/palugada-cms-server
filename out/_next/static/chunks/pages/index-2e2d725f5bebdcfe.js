(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{8312:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return a(5157)}])},18:function(e,t,a){"use strict";var n=a(6154);t.Z=n.Z.create({baseURL:"http://localhost:8080/api"})},5157:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return N}});var n=a(5893),s=a(7294),r=a(5675),o=a.n(r),i=a(74),l=a.n(i),c=a(1649);function u(e){let t=(0,c.v9)(e=>e.GlobalContextReducer.isLoading);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"".concat(l().loading," ").concat(t?"":l().hide),children:(0,n.jsx)(o(),{className:l().illustration,src:"/loading-spinner.svg",alt:"illustration",width:75,height:75,priority:!0})}),e.children]})}var d=a(9155),h=a(1163),p=a(4341),_=a.n(p),f=a(6455),m=a.n(f),g=a(3321),x=a(1703),b=a(8599);function y(){let e=(0,c.v9)(e=>e.AuthReducer.features),t=(0,d.T)(),a=(0,h.useRouter)(),r=a.pathname,[i,l]=(0,s.useState)(0),[u,p]=(0,s.useState)([]),f=["transactions","catalogs","categories","sub_categories","items","racks","suppliers","supplies","employees","roles","route_permissions","user"];async function y(e){e.preventDefault();let{isConfirmed:n}=await m().fire({icon:"question",text:"ARE YOU SURE WANT TO LOG OUT?",showDenyButton:!0,confirmButtonText:"YES",denyButtonText:"NO",showClass:{popup:"animate__animated animate__fadeInDown"},hideClass:{popup:"animate__animated animate__fadeOutUp"}});n&&(m().fire({icon:"success",text:"LOGGED OUT",showClass:{popup:"animate__animated animate__fadeInDown"},hideClass:{popup:"animate__animated animate__fadeOutUp"}}),t((0,b.lK)()),localStorage.removeItem("access_token"),a.push("/auth"))}(0,s.useEffect)(()=>{if(e.length>0){let t=f.filter(t=>e.includes(t));p(t),l(t.indexOf(r.split("/")[1]))}},[e]);let v=(e,a)=>{var n;a.preventDefault(),l(e),t((n=f[e],e=>{e({type:"GC/set-route",payload:n})}))};return(0,n.jsxs)("div",{className:_().root,children:[(0,n.jsx)("div",{className:_()["image-container"],children:(0,n.jsx)(o(),{className:_().illustration,src:"/company-logo.png",alt:"logo",width:180,height:100,priority:!0})}),(0,n.jsx)(x.Z,{orientation:"vertical",variant:"scrollable",value:i,className:_().tabs,TabIndicatorProps:{style:{backgroundColor:"red"}},children:(()=>{let e=[];return u.forEach((t,a)=>{e.push((0,n.jsx)(g.Z,{className:_()["button-tab"],onClick:e=>v(a,e),children:(0,n.jsx)("span",{style:{marginLeft:"15px"},children:t.replaceAll("_"," ")})}))}),e})()}),(0,n.jsx)(g.Z,{onClick:y,children:(0,n.jsx)("span",{style:{color:"black"},children:"LOGOUT"})}),(0,n.jsxs)("h5",{className:"text-center mb-40",children:["PALUGADA","\xae",(0,n.jsx)("br",{})," 2021"]})]})}var v=a(18);let j=()=>(console.log("fetching roles and permissions"),async e=>{let t=localStorage.getItem("access_token"),{data:a}=await v.Z.get("/roles",{headers:{Authorization:"Bearer "+t}}),{data:n}=await v.Z.get("/route_permissions",{headers:{Authorization:"Bearer "+t}});a&&n&&(e({type:"rbac/roles",payload:a.data}),e({type:"rbac/permissions",payload:n.data}))});function w(){let e=(0,d.T)();return(0,s.useEffect)(()=>{console.log("sini"),e(j())},[]),(0,n.jsx)("h1",{children:"RBAC"})}function N(){let e=(0,c.v9)(e=>e.GlobalContextReducer.routeName),t=(0,d.T)(),a=(0,h.useRouter)(),[r,o]=(0,s.useState)(!1);return((0,s.useEffect)(()=>{localStorage.getItem("access_token")?(t((0,b.AW)()),t((0,b.$j)())):a.push("/auth"),o(!0)},[]),r)?(0,n.jsx)(u,{children:(0,n.jsxs)("div",{className:"flex-start",style:{height:"100vh",width:"100%"},children:[(0,n.jsx)(y,{}),(0,n.jsx)("div",{className:"pl-75",children:"roles"===e?(0,n.jsx)(w,{}):(0,n.jsxs)("h1",{children:["GA ADA ",e]})})]})}):(0,n.jsx)(n.Fragment,{})}},8599:function(e,t,a){"use strict";a.d(t,{$j:function(){return r},AW:function(){return o},g6:function(){return i},bc:function(){return s},lK:function(){return l}});var n=a(18);let s=e=>async t=>{try{let{data:a}=await n.Z.post("/login",{external_id:e.username,password:e.password});a&&(t({type:"auth/login",payload:a.user}),function(e){for(let t in e)localStorage.setItem(t,e[t])}({access_token:a.token}),t(r()))}catch(e){return t({type:"auth/loginError"}),e}},r=()=>async e=>{let t=localStorage.getItem("access_token"),{data:a}=await n.Z.get("/features",{headers:{Authorization:"Bearer "+t}});a&&e({type:"auth/features",payload:a.features})},o=()=>async e=>{let t=localStorage.getItem("access_token"),{data:a}=await n.Z.get("/profile",{headers:{Authorization:"Bearer "+t}});a&&e({type:"auth/login",payload:a})};function i(){return e=>{e({type:"auth/turnOffLoginError"})}}function l(){return e=>{e({type:"auth/logout"})}}},74:function(e){e.exports={loading:"Global_loading__YsvMj",hide:"Global_hide__QWE2z"}},4341:function(e){e.exports={root:"Navbar_root__hAE58",tabs:"Navbar_tabs__ohPKU","button-tab":"Navbar_button-tab__10mbw","image-container":"Navbar_image-container__YmRVZ"}}},function(e){e.O(0,[212,735,774,888,179],function(){return e(e.s=8312)}),_N_E=e.O()}]);